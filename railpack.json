{
  "provider": "railway",
  "buildAptPackages": ["python3", "python3-pip", "python3-venv"],
  "steps": {
    "build": {
      "inputs": [ { "local": true, "include": ["."] } ],
      "commands": [
        "python3 -m venv .venv",
        ".venv/bin/pip install -U pip setuptools wheel",
        ".venv/bin/pip install .",
        ".venv/bin/pip uninstall -y opencv-python || true",
        ".venv/bin/pip install --no-deps opencv-python-headless==4.11.0.86"
      ],
      "deployOutputs": [ { "include": [".venv"] } ]
    }
  },
  "deploy": {
    "startCommand": "bash ./start_headless.sh",
    "aptPackages": [
      "python3",
      "python3-pip",
      "python3-venv",
      "tesseract-ocr",
      "poppler-utils"
    ],
    "paths": ["/app/.venv/bin"]
  }
}
